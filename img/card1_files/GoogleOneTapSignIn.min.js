var webApiService=function(){const e=document.getElementById("WebAPIURL")?document.getElementById("WebAPIURL").value:"";var t={getWebApiAccessToken:function(t){var a=r(n);if(0!=a.length)return t(a);var c=r(o);new Promise(function(t,o){0!=c.length&&function(t){var n=r(i);const o=e+"oauth/token/access";return $.ajax({type:"POST",url:o,dataType:"json",data:{grant_type:"refresh_token",client_id:n,refresh_token:t}})}(c).success(function(e){t(e),function(e,t){var o=n,i=e,a=new Date(t);a=a.setTime(a.setMinutes(a.getMinutes()-2));var r=".expires="+(a=new Date(a)).toUTCString();try{window.document.cookie=o+"="+i+";path=/;"+r}catch(e){console.error(e)}}(e.access_token,e[".expires"])}).error(function(e){o(e),console.log(e)})})},setTokenNames:a},n="",o="",i="";return a("user"),t;function a(e){"admin"==e?(n="_accessTokenAdmin",o="_refreshTokenAdmin",i="_clientIDAdmin"):(n="_accessToken",o="_refreshToken",i="_clientID")}function r(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}};function handleCredentialResponse(e){const t=document.getElementById("WebAPIURL")?document.getElementById("WebAPIURL").value:"";webApiService().getWebApiAccessToken(n=>{let o={shortTermAccessToken:e.credential,providerName:"GooglePlus",isOneTapSignIn:!0};fetch(t+"accounts/socialprofileinfo",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+n},body:JSON.stringify(o)}).then(e=>e.json()).then(e=>{if(e&&e.Data&&(e.Data.Email||e.Data.UserName))localStorage.setItem("otsInfo",btoa(JSON.stringify(e.Data))),window.location.href="/login.aspx?oneTapSignIn=true";else{var o="Error performing OneTap Signin. Social Data - "+JSON.stringify(e);fetch(t+"guruutility/logexception",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+n},body:JSON.stringify(o)})}}).catch(e=>{console.log(e)})})}function onSignIn(e){var t=e.getAuthResponse().id_token;const n=document.getElementById("WebAPIURL")?document.getElementById("WebAPIURL").value:"";webApiService().getWebApiAccessToken(o=>{let i={shortTermAccessToken:t,providerName:"GooglePlus",isOneTapSignIn:!0};fetch(n+"accounts/socialprofileinfo",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+o},body:JSON.stringify(i)}).then(e=>e.json()).then(t=>{if(t&&t.Data&&(t.Data.Email||t.Data.UserName))localStorage.setItem("otsInfo",btoa(JSON.stringify(t.Data))),window.location.href="/login.aspx?oneTapSignIn=true",e.disconnect();else{var i="Error performing OneTap Signin. Social Data - "+JSON.stringify(t);fetch(n+"guruutility/logexception",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+o},body:JSON.stringify(i)})}}).catch(e=>{console.log(e)})})}function CheckEmailExists(){var e=a=document.getElementById("regEmail").value;const t=document.getElementById("WebAPIURL")?document.getElementById("WebAPIURL").value:"";fetch(t+"accounts/emailexists/"+e+"/").then(e=>e.json()).then(e=>console.log(e))}window.onload=(e=>{null!=localStorage.getItem("otsInfo")&&localStorage.removeItem("otsInfo")});